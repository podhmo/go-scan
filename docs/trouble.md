# トラブルシューティングガイド

このドキュメントは、`go-scan` プロジェクトの開発中に遭遇した問題とその解決策を記録するためのものです。

---

## `go run` コマンドの標準化

- **問題**: Makefile 内で `go run main.go ...` のように特定のファイル名を指定してコマンドを実行すると、将来的に `main.go` がリファクタリングされたり、複数の `main` パッケージが追加された場合に、Makefile の修正が広範囲に必要になる可能性がある。

- **経緯**: 当初、いくつかの Makefile ターゲットが `go run main.go` を使用していた。しかし、プロジェクトの柔軟性と将来の拡張性を考慮し、より汎用的な実行方法に統一することが議論された。

- **解決策**: Makefile 内の `go run` コマンドは、原則として `go run ./ <引数...>` の形式に統一する。これにより、カレントディレクトリの `main` パッケージが対象となり、ファイル名への依存がなくなる。この変更は、`find-orphans` や `generate-bindings` などの主要なターゲットに適用された。

- **参照**: この決定に関連する議論は、特定のプルリクエストやイシューで確認できます（リンクを追記予定）。

---

## `symgo` のテスト実行環境における問題

- **問題**: `symgo` のインテグレーションテスト実行時に、`file not found` エラーが頻発し、ファイルの読み書きができない状況が発生した。また、`make format` や `make test` などのコマンドがハングアップし、タイムアウトする問題も確認された。

- **経緯**: `TODO.md` の「Analysis of Complex Packages」バグを再現するためのインテグレーションテストを作成する過程で、`replace_with_git_merge_diff` や `read_file` ツールが `symgo/interpreter.go` などのコアなファイルに対してエラーを返す事象が多発した。当初はツールのバグや自身のファイルパス指定の誤りを疑ったが、`AGENTS.md` の記述から、実行環境の作業ディレクトリ (`cwd`) が不安定になる可能性があることが判明した。

- **解決策**:
    1. **作業ディレクトリの固定**: `AGENTS.md` の指示に従い、ファイルシステムを操作する可能性のあるすべての `run_in_bash_session` コマンドの前に `cd /app &&` を追加し、常にリポジトリのルートでコマンドが実行されるようにした。
    2. **コマンドのハングアップ**: `make format` や `make test` がタイムアウトする問題は、テスト実行環境の根本的な問題である可能性が高い。現時点での直接的な解決策はないが、テストがバグを再現できることを確認した上で、これらのコマンドの完了を待たずに次のステップに進むことで作業を継続した。この問題は、インフラストラクチャ側の改善が必要である可能性を示唆している。

- **参照**: この問題の調査と解決の試みは、Jules の作業ログ全体で確認できる。特に、`reset_all` を試みた後の `pwd` の確認や、`AGENTS.md` の読解がターニングポイントとなった。
